{"title":"DES和分组密码工作模式","slug":"DES和分组密码工作模式","date":"2020-05-18T12:17:27.000Z","updated":"2020-05-18T12:26:27.339Z","comments":true,"path":"api/articles/DES和分组密码工作模式.json","photos":[],"link":"","excerpt":"信息安全试验所需。","covers":["/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/DES.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/pc_1.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/pc_1.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/pc_2.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/image-20200512205728831.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/IP&amp;IP-1.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/f(R,K","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/e_bit-selection.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/S.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/P.png","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/ECB.jpg","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/CBC.jpg","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/CFB.jpg","/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/OFB.jpg"],"content":"<p>信息安全试验所需。</p>\n<a id=\"more\"></a>\n<p>[toc]</p>\n<h1 id=\"DES\"><a href=\"#DES\" class=\"headerlink\" title=\"DES\"></a>DES</h1><p><img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/DES.png\" alt=\"DES\"></p>\n<h2 id=\"按表变换\"><a href=\"#按表变换\" class=\"headerlink\" title=\"按表变换\"></a>按表变换</h2><p>DES涉及多次依据表格进行位置变换。</p>\n<p><img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/pc_1.png\" alt=\"pc_1\"></p>\n<p>如此表，第1位的57，表示把原数据的第57位的数字移至第1位。</p>\n<p><br></p>\n<hr>\n<p><br></p>\n<h2 id=\"秘钥部分\"><a href=\"#秘钥部分\" class=\"headerlink\" title=\"秘钥部分\"></a>秘钥部分</h2><ol>\n<li><p>全长64位，但8的倍数位是奇偶校验，不参与实际加密。</p>\n</li>\n<li><p>PC-1变换：64分8组，按照PC-1表进行变换，此步表中没有8*k位置（此步消去奇偶校验位），得到56位秘钥。</p>\n<p> <img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/pc_1.png\" alt=\"pc_1\"></p>\n</li>\n<li><p>拆分：56位秘钥左右均分为$C_0$和$D_0$（各28位）</p>\n</li>\n<li><p>循环左移：将上述两部分，各自逐次循环左移16次，得到$C_i,D_i \\ (i\\in[1,16])$</p>\n<ul>\n<li>i=1,2,9,16时是左移1位<strong>得到</strong></li>\n<li><p>其余左移2位<strong>得到</strong></p>\n<blockquote>\n<p>$C_0 = 1111000011001100101010101111<br>\\\\ C_1 = 1110000110011001010101011111$</p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li><p>合并：$C_iD_i$ </p>\n</li>\n<li><p>PC-2变换：得到子秘钥$K_i$，此步表中仅48位，即子秘钥仅48位（删除C的第9,18,22,25位以及D的第7,9,15,26比特位）</p>\n<p> <img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/pc_2.png\" alt=\"pc_2\"></p>\n</li>\n</ol>\n<p>总过程：原秘钥（64） -&gt; PC-1（56↓） -&gt; 两侧循环左移（28×2） -&gt; PC-2（48↓） -&gt; 子秘钥$K_i $（48）</p>\n<p><img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/image-20200512205728831.png\" alt=\"image-20200512205728831\"></p>\n<p><br></p>\n<hr>\n<p><br></p>\n<h2 id=\"信息部分\"><a href=\"#信息部分\" class=\"headerlink\" title=\"信息部分\"></a>信息部分</h2><p>DES基于组块，每块64位。</p>\n<ol>\n<li><p>初始变换IP（Initial permutation）：右上是IP表，右下是IP逆的表。两表互为逆操作。</p>\n<p> <img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/IP&amp;IP-1.png\" alt=\"IP&amp;IP-1\"></p>\n</li>\n<li><p>分块：64位均分为左右$L_0、 \\ R_0$，各32位</p>\n</li>\n<li><p>16次迭代：</p>\n<script type=\"math/tex; mode=display\">\n L_i = R_{i-1}\n \\\\ R_i = L_{i-1} \\ XOR \\ f(R_{i-1}, \\ K_i)</script></li>\n<li><p>$f(R_{i-1}, \\ K_{i})$：输入两个32位，输出一个32位</p>\n<p> <img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/f(R,K\" alt=\"f(R,K)\">.png)</p>\n<ol>\n<li><p>扩展置换E：$R_{i-1}$ 经下表扩展至48位</p>\n<p> <img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/e_bit-selection.png\" alt=\"e_bit-selection\"></p>\n</li>\n<li><p>XOR：扩展所得与子秘钥异或 $E(R_{i-1}) \\ XOR \\ K_i$ </p>\n</li>\n<li><p>S盒替换：将异或得到的48位结果分成八个6位的块，每一块通过对应的一个S盒产生一个4位的输出。</p>\n<p> 每个S盒都是4×16的矩阵。例如块1：$x_1x_2x_3x_4x_5x_6$，将$x_1x_6$转为10进制作为S盒1的行号，将$x_2x_3x_4x_5$转为10进制作为S盒1的列号，则确定一个数字，转为4位二进制。</p>\n<p> 最终实现每块的6位-&gt;4位，整体的32位。</p>\n<p> <img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/S.png\" alt=\"S\"></p>\n</li>\n<li><p>P置换：将上述所得进行移位变换，得32位</p>\n<p> <img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/P.png\" alt=\"P\"></p>\n</li>\n</ol>\n</li>\n<li><p>16次后，得到$L_{16}, \\ R_{16}$，将其倒置得$R_{16}L_{16}(64)$，进行IP逆置换，得到最终密文。</p>\n</li>\n</ol>\n<p><br></p>\n<hr>\n<p><br></p>\n<h2 id=\"解密\"><a href=\"#解密\" class=\"headerlink\" title=\"解密\"></a>解密</h2><p>仅将秘钥调换使用顺序（$K_{16},K_{15},…,K_1$），其余与加密相同。</p>\n<p><br></p>\n<p><br></p>\n<h1 id=\"分组密码工作模式\"><a href=\"#分组密码工作模式\" class=\"headerlink\" title=\"分组密码工作模式\"></a>分组密码工作模式</h1><h2 id=\"ECB\"><a href=\"#ECB\" class=\"headerlink\" title=\"ECB\"></a>ECB</h2><p>电子密码本ECB (electronic codebookmode)</p>\n<p><img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/ECB.jpg\" alt=\"ECB\"></p>\n<ul>\n<li>最简单的方法：原数据分组后按顺序加密，之后将所得密文按顺序连接即可</li>\n<li>特点<ul>\n<li>简单可并行</li>\n<li>不能隐藏明文的模式信息</li>\n<li>加密消息块相互独立成为被攻击的弱点（可能主动攻击明文）</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"CBC\"><a href=\"#CBC\" class=\"headerlink\" title=\"CBC\"></a>CBC</h2><p>密码分组链接CBC (cipher blockchaining)</p>\n<p><img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/CBC.jpg\" alt=\"CBC\"></p>\n<ul>\n<li>使加密的各段数据之间有了联系</li>\n<li>解密时先解密再与初始向量/<strong>密文</strong>异或</li>\n<li>解密后补位数据要删除</li>\n<li>特点：<ul>\n<li>加密无法并行</li>\n<li>隐藏明文的模式信息（相同明文块，生成密文不同）</li>\n<li>不易对明文主动攻击</li>\n<li>密文块损坏导致两明文块损坏</li>\n<li>安全性更好，更适合长报文传输</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"CFB\"><a href=\"#CFB\" class=\"headerlink\" title=\"CFB\"></a>CFB</h2><p>密码反馈CFB (cipher feedback)</p>\n<p><img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/CFB.jpg\" alt=\"CFB\"></p>\n<p>使用一个与块大小相同的移位寄存器（用IV初始化）。将其加密后，取高n位（K块作用）与明文的n位异或。随后寄存器左移n位，将得到的n位密文补至尾部。</p>\n<p>特点：</p>\n<ul>\n<li>流密码</li>\n<li>隐藏明文模式</li>\n<li>误差传递：一个单元损坏影响多个单元</li>\n</ul>\n<h2 id=\"OFB\"><a href=\"#OFB\" class=\"headerlink\" title=\"OFB\"></a>OFB</h2><p>输出反馈OFB (output feedback)</p>\n<p><img src=\"/2020/05/18/DES%E5%92%8C%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/OFB.jpg\" alt=\"OFB\"></p>\n<p>特点：</p>\n<ul>\n<li>流密码</li>\n<li>隐藏了明文模式</li>\n<li>误差传递：一个单元损坏只影响对应单元</li>\n<li>对明文的主动攻击是可能的,信息块可被替换、重放</li>\n<li>安全性较CFB差</li>\n</ul>\n","categories":[],"tags":[{"name":"信息安全","slug":"信息安全","count":1,"path":"api/tags/信息安全.json"}]}