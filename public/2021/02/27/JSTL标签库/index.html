<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="gaylong9">



    <meta name="description" content="年更博客 自娱自乐">



<title>JSTL标签库 | gaylong9`s blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


<meta name="generator" content="Hexo 4.2.0"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">gaylong9&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">gaylong9&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">JSTL标签库</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">gaylong9</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">February 27, 2021&nbsp;&nbsp;20:55:44</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <p> </p>
<a id="more"></a>
<!-- toc -->
<ul>
<li><a href="#jstl%E6%A0%87%E7%AD%BE%E5%BA%93">JSTL标签库</a>
<ul>
<li><a href="#1-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A0%87%E7%AD%BE%E5%BA%93%E6%AD%A5%E9%AA%A4">1. 使用第三方标签库步骤</a></li>
<li><a href="#2-jstl%E6%A0%87%E7%AD%BE%E5%BA%93%E7%AE%80%E4%BB%8B">2. JSTL标签库简介</a></li>
<li><a href="#3-core">3. Core</a>
<ul>
<li><a href="#31-%E4%B8%80%E8%88%AC%E7%94%A8%E9%80%94%E6%A0%87%E7%AD%BE">3.1 一般用途标签</a></li>
<li><a href="#32-%E6%9D%A1%E4%BB%B6%E6%A0%87%E7%AD%BE">3.2 条件标签</a></li>
<li><a href="#33-%E8%BF%AD%E4%BB%A3%E6%A0%87%E7%AD%BE">3.3 迭代标签</a></li>
<li><a href="#34-url%E7%9B%B8%E5%85%B3%E6%A0%87%E7%AD%BE">3.4 URL相关标签</a></li>
</ul>
</li>
<li><a href="#4-i18n">4. I18N</a>
<ul>
<li><a href="#41-%E5%9B%BD%E9%99%85%E5%8C%96">4.1 国际化</a></li>
<li><a href="#42-java%E5%AF%B9i18n%E7%9A%84%E6%94%AF%E6%8C%81">4.2 Java对I18N的支持</a></li>
<li><a href="#43-%E5%9B%BD%E9%99%85%E5%8C%96%E6%A0%87%E7%AD%BE">4.3 国际化标签</a></li>
<li><a href="#44-%E5%BA%94%E7%94%A8%E7%BB%93%E6%9E%84%E4%B8%8E%E4%B8%AD%E6%96%87%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6">4.4 应用结构与中文资源文件</a></li>
<li><a href="#45-%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A0%87%E7%AD%BE">4.5 格式化标签</a></li>
</ul>
</li>
<li><a href="#5-sql">5. SQL</a></li>
<li><a href="#6-functions">6. Functions</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<p> </p>
<p>[toc]</p>
<p> </p>
<h1><span id="jstl标签库"> JSTL标签库</span></h1>
<p>自定义JSP标签用来替代Java程序片段，有些JSP常要使用的功能，如重定向、include、格式化输出、访问数据库、流程控制等。Oracle公司制定了一组标准标签库 JSTL（JavaServer Pages Standard Tag Library）。</p>
<p> </p>
<h2><span id="1-使用第三方标签库步骤"> 1. 使用第三方标签库步骤</span></h2>
<p>提供标签库的第三方，将所有文件打包为JAR包，包含：标签处理类及相关类的class文件，含有TLD的META-INF目录。</p>
<p>使用方法：把JAR文件复制到<code>&lt;CATALINA_HOME&gt;/lib</code>或<code>webapp/WEB-INF/lib</code>下，JSP中通过taglib声明标签库，uri属性与TLD中的uri一致。</p>
<p>运行此标签时，容器自动到JAR的META-INF下读取TLD。</p>
<p> </p>
<h2><span id="2-jstl标签库简介"> 2. JSTL标签库简介</span></h2>
<ol>
<li>包含5个标签库，URI和前缀做了约定：
<ol>
<li>Core：c <code>http://java.sun.com/jsp/jstl/core</code>，核心标签库，包括一般标签、条件标签、迭代标签、URL相关标签</li>
<li>I18N：fmt <code>http://java.sun.com/jsp/jstl/fmt</code>，国际化，日期时间数字格式化</li>
<li>Sql：sql <code>http://java.sun.com/jsp/jstl/sql</code>，访问关系数据库</li>
<li>Xml：x <code>http://java.sun.com/jsp/jstl/xml</code>，对XML文档操作</li>
<li>Functions：fn <code>http://java.sun.com/jsp/jstl/functions</code>，通用的EL函数，EL表达式中可以使用这些EL函数</li>
</ol>
</li>
<li>要使用JSTL，需要下载JSTL安装包，包括<code>taglibs-standard-impl-X.jar</code>和<code>taglibs-standard-spec-X.jar</code>；前者包含Apache开源软件组织用于实现JSTL的class文件，在其META-INF下，包含了5个标签库的TLD；后者包含JSTL规范中定义的接口的类的class文件；下载后把两jar文件复制到<code>&lt;CATALINA_HOME&gt;/lib</code>或<code>webapp/WEB-INF/lib</code>下</li>
<li>IDEA使用：
<ol>
<li>WEB-INF下新建lib包，放入jstl的jar包 <a href="http://archive.apache.org/dist/jakarta/taglibs/standard/binaries/" target="_blank" rel="noopener">http://archive.apache.org/dist/jakarta/taglibs/standard/binaries/</a></li>
<li>File-Project Structure-Modules-Add-JARs-选择到lib-勾选-应用</li>
<li>使用taglib指令导入jar包到jsp页面 <code>&lt;%@taglib uri=&quot;jar包网址&quot; prefix=&quot;代用名&quot;%&gt;</code></li>
</ol>
</li>
<li>在JSP中使用库时，要先taglib引入标签库</li>
</ol>
<p> </p>
<h2><span id="3-core"> 3. Core</span></h2>
<p><code>&lt;%@ taglib uri=&quot;http:/java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;</code></p>
<h3><span id="31-一般用途标签"> 3.1 一般用途标签</span></h3>
<p><code>&lt;c:out&gt;</code>：把表达式结果打印到网页</p>
<p><code>&lt;c:set&gt;</code>：设定命名变量（存放在特定范围内的属性）的值，JavaBean的属性的值，Map的Key的值</p>
<p><code>&lt;c:remove&gt;</code>：删除一个命名变量</p>
<p><code>&lt;c:catch&gt;</code>：捕获异常，并把异常对象放在页面范围内指定的命名变量中</p>
<ol>
<li>
<p><code>&lt;c:out value=&quot;表达式&quot;/&gt;</code></p>
<ol>
<li>
<p><strong>表达式可以是<code>&lt;%= %&gt;</code>的Java表达式，也可以是EL表达式（以下命名变量名字target属性也如此）</strong></p>
</li>
<li>
<p>设置默认值后，表达式为null时输出默认值</p>
<p><code>&lt;c:out value=&quot;&quot; default=&quot;&quot; /&gt;</code></p>
<p><code>&lt;c:out value=&quot;&quot;&gt; default_content &lt;/c:out&gt;</code></p>
</li>
</ol>
</li>
<li>
<p><code>&lt;c:set&gt;</code></p>
<ol>
<li>为String类型命名变量设定值（或设定一个新的命名变量）：<code>&lt;c:set var=&quot;命名变量的名字&quot; value=&quot;表达式&quot; scope=&quot;{page|request|session|application} /&gt;&quot;</code> 或 <code>&lt;c:set var=“命名变量” scope=&quot;&quot;&gt; value &lt;/c:set&gt;</code>范围默认page</li>
<li>设定JavaBean的属性的值：<code>&lt;c:set var=&quot;JavaBean命名变量&quot; property=&quot;JavaBean的属性名&quot; value=&quot;表达式&quot; /&gt;</code></li>
<li>设置Map的Key的值：<code>&lt;c:set target=&quot;Map对象命名变量&quot; property=&quot;key的名字&quot; value=&quot;表达式&quot; /&gt;</code></li>
<li>前一种set时，var属性的值直接使用名字即可，后两种target属性的值，是对象的命名变量，要用表达式，如<code>${bean}</code></li>
</ol>
</li>
<li>
<p><code>&lt;c:remove var=&quot;命名变量的名字&quot; scope=&quot;&quot; /&gt;</code> 如不指定范围，则删除全部范围内的此名属性</p>
</li>
<li>
<p><code>&lt;c:catch var=&quot;代表异常对象的命名变量的名字&quot;&gt; &lt;% 一段代码 %&gt; &lt;/c:catch&gt;</code> 捕获标签主体内代码的异常，存入页面范围内指定的命名变量中</p>
</li>
</ol>
<h3><span id="32-条件标签"> 3.2 条件标签</span></h3>
<p><code>&lt;c:if&gt;</code> <code>&lt;c:choose&gt;</code> <code>&lt;c:when&gt;</code> <code>&lt;c:otherwise&gt;</code> 替代Java中的if和if-else。</p>
<ol>
<li>
<p><code>&lt;c:if&gt;</code></p>
<ol>
<li><code>&lt;c:if test=&quot;逻辑表达式&quot; var=&quot;代表逻辑表达式的值的命名变量的名字&quot; scope=&quot;&quot; /&gt;</code> 把逻辑表达式的值存入var的命名变量中，默认page范围</li>
<li><code>&lt;c:if test=&quot;逻辑表达式&quot;&gt;标签主体&lt;/c:if&gt;</code> true时执行标签主体</li>
</ol>
</li>
<li>
<p><code>&lt;c:choose&gt;</code> <code>&lt;c:when&gt;</code> <code>&lt;c:otherwise&gt;</code>三标签连用，实现if-else</p>
 <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:choose&gt;</span><br><span class="line">    &lt;c:when test=<span class="string">"$&#123;empty param.username&#125;"</span>&gt;</span><br><span class="line">        Unknown user.    </span><br><span class="line">    &lt;/c:when&gt;</span><br><span class="line">    &lt;c:when test=<span class="string">"$&#123;param.username=='Tom'&#125;"</span>&gt;</span><br><span class="line">        $&#123;param.username&#125; is type-a.</span><br><span class="line">    &lt;/c:when&gt;</span><br><span class="line">    &lt;c:otherwise&gt;</span><br><span class="line">        $&#123;param.username&#125; is type-b.</span><br><span class="line">    &lt;/c:otherwise&gt;</span><br><span class="line">&lt;/c:choose&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>when和otherwise必须在choose父标签下</li>
<li>choose中可以多个when</li>
<li>choose中可以没有otherwise</li>
<li>choose中若when和otherwise都有，则otherwise必须在when后</li>
</ol>
</li>
</ol>
<h3><span id="33-迭代标签"> 3.3 迭代标签</span></h3>
<p><code>&lt;c:forEach&gt;</code> 遍历集合中的对象，能重复执行标签主体</p>
<p><code>&lt;c:forTokens&gt;</code> 遍历字符串中用特定分割符分割的子串，能重复执行标签主体</p>
<ol>
<li><code>&lt;c:forEach&gt;</code>
<ol>
<li>基本语法：<code>&lt;c:forEach var=&quot;集合中一个元素的命名变量的名字&quot; items=&quot;集合&quot;&gt; 主体 &lt;/c:forEach&gt;</code> 每次取出一个元素，放入NESTED范围（当前标签主体构成的范围）内的命名变量中，仅标签主体中可以访问这个命名变量</li>
<li>varStatus属性：设定一个javax.servlet.jsp.jstl.core.LoopTagStatus类型的命名变量，谓语NESTED范围，包含从集合中取出的当前元素的状态信息：
<ol>
<li>count：该元素在集合中的序号（1开始）</li>
<li>index：索引（0开始）</li>
<li>first：是否是集合第一个元素</li>
<li>last：是否是集合最后一个元素</li>
</ol>
</li>
<li>begin、end、step属性：循环的起始索引、结束索引、步长，另如未指定集合，用此属性，则是将数字看作集合</li>
<li>本标签可以访问的集合：集合类、数组、以逗号分割的字符串</li>
</ol>
</li>
<li><code>&lt;c:forTokens var=&quot;代表子串的命名变量的名字&quot; items=&quot;被分割的字符串&quot; delims=&quot;分割符&quot;&gt; 主体 &lt;/c:forTokens&gt;</code> 本标签也有varStatus、begin、end、step属性</li>
</ol>
<h3><span id="34-url相关标签"> 3.4 URL相关标签</span></h3>
<p><code>&lt;c:import&gt;</code>：包含其他Web资源</p>
<p><code>&lt;c:url&gt;</code>：按照特定重写规则重构URL</p>
<p><code>&lt;c:redirect&gt;</code>：重定向</p>
<ol>
<li><code>&lt;c:import url=&quot;资源URL&quot;&gt;</code>
<ol>
<li>类似<code>&lt;jsp:include&gt;</code>，但本标签还可以包含其他Web应用中的资源，甚至是其他网站的资源</li>
<li>包含当前Web应用中的资源时，可以是非/开头的相对路径，也可以是/开头的绝对路径（绝对路径以webapp下的文件夹开始，实际上/开头的话，容器会自动前缀应用根路径，故从webapp后开写即可）</li>
<li>包含其它网站的文件时，url属性以<code>http://</code>开头的绝对路径</li>
<li>包含同一容器中其他Web应用的资源时，首先要在本应用的META-INF/context.xml中，把<code>&lt;Context&gt;</code>的corssContext属性设为true，随后在本应用的<code>&lt;c:import url=&quot;/dir/target.jsp&quot; context=&quot;/anotherweb&quot; /&gt;</code>中加入context属性</li>
<li>还可使用var属性，将目标文件的内容，不直接包含到当前文件，而是保存在var属性设定的命名变量中</li>
</ol>
</li>
<li><code>&lt;c:url value=&quot;原始URL&quot; var=&quot;存放新URL的命名变量&quot; scope=&quot;&quot; /&gt;</code>
<ol>
<li>重构/创建URL，把新URL放在var指定的命名变量中，默认page范围</li>
<li>不以/开头的相对路径，和以/开头的绝对路径（绝对路径时自动前缀根路径，最终的URL是带有根路径的）</li>
<li>可以包含<code>&lt;c:param name=&quot;username&quot; value=&quot;Tom&quot;&gt;</code>子标签，用于设定请求参数，并且此标签能对value中的各种符号正确编码，如&gt; &amp;等，代码正常写即可</li>
</ol>
</li>
<li><code>&lt;c:redirect url=&quot;目标Web资源的URL&quot; /&gt;</code>，重定向，也可使用context属性指向其他Web应用，和<code>&lt;c:param&gt;</code>标签指定参数</li>
</ol>
<p> </p>
<h2><span id="4-i18n"> 4. I18N</span></h2>
<p>国际化，时间日期数字格式化</p>
<p><code>&lt;%@ taglib prefix=&quot;fmt&quot; uri=&quot;http://java.sun.com/jsp/jstl/fmt&quot; %&gt;</code></p>
<h3><span id="41-国际化"> 4.1 国际化</span></h3>
<p>即I18N（Internationalization），指软件设计阶段，就应该使软件具有支持多种语言和地区的功能。如此，添加新语言和国家支持时，不需大量返工，无需修改代码。</p>
<p>应将文本、图片等资源抽离出来，储存在外部，根据用户不同，调用不同资源。</p>
<p>Locale本地，指地理区域。</p>
<p> </p>
<h3><span id="42-java对i18n的支持"> 4.2 Java对I18N的支持</span></h3>
<p>核心库中提供了一些支持国际化的类和接口。JSTL的I18N标签库依赖于这些类。</p>
<ol>
<li>
<p>Locale类：</p>
<ol>
<li>java.util.Locale，实例代表一个特定语言和地区</li>
<li>若某个类运行时需要依据Locale对象，就称该类是本地敏感的</li>
<li>Locale对象本身不执行和I18N相关的工作，仅负责向本地敏感的类提供本地信息</li>
<li>创建时要提供语言和国家代码 <code>var zhLocale = new Locale(&quot;zh&quot;, &quot;CN&quot;)</code>
<ol>
<li>语言代码：两个小写字母，ISO-639规范 <a href="https://www.iso.org/iso-639-language-codes.html" target="_blank" rel="noopener">完整语言代码列表</a></li>
<li>国家代码：两个大写字母，ISO-3166规范 <a href="https://www.iso.org/iso-3166-country-codes.html" target="_blank" rel="noopener">完整国家代码列表</a></li>
</ol>
</li>
<li>本类提供一些静态常量，代表常用实例对象 <code>var jp = Locale.JAPAN</code></li>
<li>虚拟机中Locale对象来源：Java虚拟机启动时查询操作系统，为运行环境设置默认Locale，可通过本类静态方法<code>getLocale()</code>获得</li>
<li>容器中的Locale对象：容器默认使用虚拟机中Locale；而Web应用中，HTTP请求头也包含了Locale信息，故可使用HttpServletRequest对象的<code>getLocale()</code>或<code>getLocales()</code>方法，访问请求头的Accept-Language项，返回用户优先使用的Locale或优先级降序的Enumeration集合对象；若用户未设置，则使用默认Locale</li>
</ol>
</li>
<li>
<p>ResourceBundle类：</p>
<ol>
<li>
<p>java.util.ResourceBundle，存放和管理Locale相关资源，包括文本、状态信息、图片名、正常消息、错误消息、网页标题等</p>
</li>
<li>
<p>实例化工厂方法：<code>getBundle(String baseName)</code> <code>getBundle(String baseName, Locale locale)</code>  baseName：指定资源文件名字；locale如不指定则默认</p>
</li>
<li>
<p>资源文件以“properties”为扩展名，文件名为“resource_zh_CN”类似格式，不加最后4个字母，则为默认资源，实例化本类是baseName指定“resource”即可，使用哪个资源文件，可根据传入Locale判断</p>
</li>
<li>
<p>实例化一个ResourceBundle对象，它将resource_zh_CN.properties加载到内存</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> zhLocale = <span class="keyword">new</span> Locale(<span class="string">"zh"</span>, <span class="string">"CN"</span>);</span><br><span class="line"><span class="keyword">var</span> bundle = ResourceBundle.getBundle(<span class="string">"resource"</span>, zhLocale);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>getString(String key)</code> 本方法根据参数key，返回匹配到的消息文本；如资源文件中有<code>hello=Nice to meet you.</code>，<code>bundle.getString(&quot;hello&quot;)</code>即可得到Nice to meet you.</p>
</li>
</ol>
</li>
<li>
<p>MessageFormat类：</p>
<p>如以下资源文件：</p>
 <figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">error.requiredfield.name</span> = <span class="string">The name is required</span></span><br><span class="line"><span class="meta">error.requiredfield.phone</span> = <span class="string">The phone is required</span></span><br></pre></td></tr></table></figure>
<p>仅部分内容不同，如需要大量类似资源时，十分冗杂，可使用本类功能，把资源文件改为：</p>
 <figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">error.requiredfield</span> = <span class="string">The &#123;0&#125; is required</span></span><br><span class="line"><span class="meta">label.phone</span> = <span class="string">phone</span></span><br><span class="line"><span class="meta">label.name</span> = <span class="string">name</span></span><br></pre></td></tr></table></figure>
<p>其中{0}是消息参数，数字可增加。运行时，MessageFormat类的<code>format()</code>方法可以把消息参数{0}替换成真正需要的动态文本内容：</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建bundle，加载资源文件</span></span><br><span class="line"><span class="keyword">var</span> bundle = ResourceBundle.getBundle(<span class="string">"resource"</span>);</span><br><span class="line"><span class="comment">// 获取消息模板</span></span><br><span class="line">String requiredFiledMessage = bundle.getString(<span class="string">"error.requiredfield"</span>);</span><br><span class="line"><span class="comment">// 创建存放消息参数的数组</span></span><br><span class="line">Object[] messageArgs = <span class="keyword">new</span> Object[<span class="number">1</span>];</span><br><span class="line"><span class="comment">// 读取label.name对应文本</span></span><br><span class="line">messageArgs[<span class="number">0</span>] = bundle.getString(<span class="string">"label.name"</span>);</span><br><span class="line"><span class="comment">//格式化消息</span></span><br><span class="line">String formattedNameMessage = MessageFormat.format(requiredFieldMessage, messageArgs);</span><br><span class="line"><span class="comment">// 如此，formattedNameMessage即为最终的动态消息文本</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p> </p>
<h3><span id="43-国际化标签"> 4.3 国际化标签</span></h3>
<p><code>&lt;fmt:setLocale&gt;</code>：设置Locale，保存到特定范围</p>
<p><code>&lt;fmt:setBundle&gt;</code>：设置ResourceBundle，保存到特定范围</p>
<p><code>&lt;fmt:bundle&gt;</code>：设置标签主体使用的ResourceBundle</p>
<p><code>&lt;fmt:message&gt;</code>：根据属性key返回ResourceBundle中匹配的消息文本</p>
<p><code>&lt;fmt:param&gt;</code>：为消息文本中的消息参数设置值</p>
<p><code>&lt;fmt:requestEncoding&gt;</code>：设置HTTP请求正文使用的字符编码</p>
<ol>
<li>
<p><code>&lt;fmt:setLocale value=&quot;locale对象&quot; scope=&quot;&quot;&gt;</code> 保存该属性的名字（命名变量名字）是JSTL API中的javax.servlet.jsp.jstl.Config类的一个静态常量FMT_LOCALE + scope，值为“javax.servlet.jsp.jstl.fmt.locale.{page|…}”，</p>
</li>
<li>
<p><code>&lt;fmt:setBundle basename=&quot;资源文件名字&quot; var=&quot;命名变量名字&quot; scope=&quot;&quot;&gt;</code>，如不指定var，则命名变量名字为Config.FMT_LOCALIZATION_CONTEXT，即“javax.servlet.jsp.jstl.fmt.localizationContext”，如此，本Bundle即为范围内默认Bundle</p>
</li>
<li>
<p><code>&lt;fmt:bundle basename=&quot;资源文件名字&quot; prefix=&quot;消息key的前缀&quot;&gt; 标签主体 &lt;/fmt:bundle&gt;</code>  设置标签主体所用bundle，当要使用的key有相同前缀时，可把公共部分提至prefix中</p>
</li>
<li>
<p><code>&lt;fmt:message key=&quot;&quot;&gt;</code> 根据key，返回bundle中匹配的消息文本</p>
</li>
<li>
<p><code>&lt;fmt:param value=&quot;&quot;&gt;</code> 嵌套在message标签中，用于生成动态消息文本，类似MessageFormat类功能，如资源文件有：<code>hello.hi=hello {0}, time is {1}.</code>，标签则</p>
 <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:formatDate value=<span class="string">"&lt;%=new Date()%&gt;"</span> type=<span class="string">"both"</span> <span class="keyword">var</span>=<span class="string">"now"</span> /&gt;</span><br><span class="line">&lt;fmt:message key=<span class="string">"hello.hi"</span>&gt;</span><br><span class="line">    &lt;fmt:param value=<span class="string">"Tom"</span>/&gt;</span><br><span class="line">    &lt;fmt:param value=<span class="string">"$&#123;now&#125;"</span>/&gt;</span><br><span class="line">&lt;/fmt:message&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>&lt;fmt:requestEncoding value=&quot;&quot;&gt;</code> 设置HTTP请求正文使用的字符编码，等价于<code>&lt;% request.setCharacterEncoding(&quot;&quot;)</code></p>
</li>
</ol>
<p> </p>
<h3><span id="44-应用结构与中文资源文件"> 4.4 应用结构与中文资源文件</span></h3>
<p><img src="/2021/02/27/JSTL%E6%A0%87%E7%AD%BE%E5%BA%93/%E5%BA%94%E7%94%A8%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.jpg" alt="应用目录结构"></p>
<p>英文资源文件可直接生成，中文则需如下步骤：</p>
<ol>
<li>
<p>messages_temp.properties，正常编写资源项，如<code>hello.title=主页</code></p>
</li>
<li>
<p>利用JDK提供的native2ascii命令进行字符编码转换</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">native2ascii -encoding gb2312 messages_temp.properties messages_zh_CN.properties</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p> </p>
<h3><span id="45-格式化标签"> 4.5 格式化标签</span></h3>
<p><code>&lt;fmt:setTimeZone&gt;</code>：设置时区，把时区保存到特定范围</p>
<p><code>&lt;fmt:timeZone&gt;</code>：设置标签主体使用的时区</p>
<p><code>&lt;fmt:formatNumber&gt;</code>：格式化数字</p>
<p><code>&lt;fmt:parseNumber&gt;</code>：解析被格式化的字符串类型的数字</p>
<p><code>&lt;fmt:formatDate&gt;</code>：格式化日期和时间</p>
<p><code>&lt;fmt:purseDate&gt;</code>：解析格式化的字符串类型的日期和时间</p>
<ol>
<li><code>&lt;fmt:setTimeZone value=&quot;时区&quot; var=&quot;命名变量的名字&quot; scope=&quot;&quot;&gt;</code>
<ol>
<li>默认page范围</li>
<li>如未指定var，则命名变量采用javax.servlet.jsp.jstl.core.Config类的静态字符串常量FMT_TIME_ZONE的值，即“javax.servlet.jsp.jstl.fmt.timeZone”，该标签设置的时区将作为特定范围内的默认时区</li>
</ol>
</li>
<li><code>&lt;fmt:timeZone value=&quot;时区&quot;&gt; 主体 &lt;/fmt:timeZone&gt;</code>设置当前标签主体的时区</li>
<li><code>&lt;fmt:formatNumber&gt;</code> 格式化数字，具有多个属性：
<ul>
<li>value：待格式化数字</li>
<li>var：指定命名变量的名字，<strong>不指定就直接输出，指定后不输出只存放，其他标签也如此</strong></li>
<li>scope：格式化后数字存放范围，默认page</li>
<li>type：数字类型，可选值number、currency、percent，默认number</li>
<li>pattern：自定义的格式化样式，详细用法参考java.text.DecimalFormat的文档</li>
<li>currencyCode：ISO4271货币代码</li>
<li>currencySymbol：货币符号，如$，如未设置则根据当前Locale自动设置</li>
<li>groupingUsed：指定是否使用对数字进行分组显示的分隔符，默认true，如123456输出显示123,456</li>
<li>maxIntegerDigits：指定整数部分的最大的数字位数</li>
<li>minIntegerDigits：指定整数部分最小的数字位数</li>
<li>maxFractionDigits：指定小数部分的最大的数字位数</li>
<li>minFractionDigits：指定小数部分的最小的数字位数，此四项类似设置宽度，多余数字四舍五入</li>
</ul>
</li>
<li><code>&lt;fmt:parseNumber&gt;</code> 将已格式化后的字符串形式的数字货币百分数转换为数字类型
<ul>
<li>value：待解析的字符串</li>
<li>type：按照何种类型解析</li>
<li>pattern：自定义格式化样式</li>
<li>parseLocale：按照何种Locale习惯解析</li>
<li>integerOnly：是否只解析整数部分，默认false</li>
<li>var：命名变量名字</li>
<li>scope：结果存放范围，默认page</li>
</ul>
</li>
<li><code>&lt;fmt:formatDate&gt;</code>：格式化日期和时间
<ul>
<li>value：待格式化的日期或时间</li>
<li>type：格式化的是日期还是时间还是都有date、time、both</li>
<li>dateStyle：日期的格式化样式，默认default，有default、short、medium、long、full可选，详细用法java.text.DateFormat</li>
<li>timeStyle：时间的格式化样式，默认default，详细用法同上</li>
<li>pattern：自定义的格式化样式，详细用法java.text.SimpleDateFormat</li>
<li>timeZone：指定使用的时区</li>
<li>var：命名变量名字</li>
<li>scope</li>
</ul>
</li>
<li><code>&lt;fmt:purseDate&gt;</code>：解析格式化的字符串类型的日期和时间
<ul>
<li>value：待解析字符串</li>
<li>type：按照何种类型解析，date、time、both，默认date</li>
<li>dateStyle，默认default</li>
<li>timeStyle：默认default</li>
<li>pattern：自定义样式</li>
<li>parseLocale：按照哪个Locale习惯解析</li>
<li>timeZone：使用的时区</li>
<li>var：命名变量名字</li>
<li>scope</li>
</ul>
</li>
</ol>
<p> </p>
<h2><span id="5-sql"> 5. SQL</span></h2>
<p>大型Web采用MVC设计模式，访问数据库任务由模型层JavaBean完成。小型Web中访问数据库可以在JSP中执行。JSTL SQL标签用于访问数据库，避免Java代码片段的冗长。</p>
<p><code>&lt;%@ taglib prefix=&quot;sql&quot; uri=&quot;http://java.sun.com/jsp/jstl/sql&quot; %&gt;</code></p>
<p><code>&lt;sql:setDataSource&gt;</code>：设置数据源</p>
<p><code>&lt;sql:query&gt;</code>：执行select语句</p>
<p><code>&lt;sql:param&gt;</code>：为SQL语句中用？表示的参数赋值</p>
<p><code>&lt;sql:dateParam&gt;</code>：为SQL语句中用？表示的日期或时间类型的参数赋值</p>
<p><code>&lt;sql:update&gt;</code>：insert、update、delete语句</p>
<p><code>&lt;sql:transaction&gt;</code>：声明数据库事务</p>
<p> </p>
<ol>
<li>
<p><code>&lt;sql:setDataSource&gt;</code></p>
<ol>
<li>数据源来源：
<ol>
<li>容器提供的数据源：若已配置过数据源，如一个JNDI名字为“jdbc/BookDB”的数据源，则<code>&lt;sql:setDataSource dateSource=&quot;jdbc/BookDB&quot;/&gt;</code></li>
<li>标签自身创建数据源，<code>&lt;sql:setDataSource url=&quot;jdbc:mysql://localhost:3306/BookDB?useUnicode=true&amp;charanterEncoding=GB2312&amp;useSSL=false&quot; driver=&quot;com.mysql.jdbc.Driver&quot; user=&quot;dbuser&quot; password=&quot;1234&quot; /&gt;</code></li>
</ol>
</li>
<li>另有var，scope属性，将数据源保存在特定范围的命名变量，默认page</li>
<li>若没有指定var，则默认使用javax.serlvet.jsp.jstl.core.Config类的静态常量SQL_DATA_SOURCE的值“javax.servlet.jsp.jstl.sql.dataSource”，作为范围内默认数据源</li>
</ol>
</li>
<li>
<p><code>&lt;sql:query&gt;</code> select查询</p>
<ol>
<li>
<p>属性如下：</p>
<ul>
<li>sql：select语句，可在标签属性中写出，也可在标签主体写出</li>
<li>dataSource：数据源，如不指定，使用由<code>&lt;sql:setDataSource&gt;</code>指定的默认源</li>
<li>maxRows：从原始查询结果中取出的最大记录数目</li>
<li>startRow：从原始查询结果中第几条记录开始取出，索引0开始</li>
<li>var：查询结果的命名变量</li>
<li>scope：查询结果存放范围</li>
</ul>
</li>
<li>
<p>返回结果：javax.servlet.jsp.jstl.sql.Result类型，该接口有如下方法：</p>
<ul>
<li>String[] getColumnNames()：返回结果中所有列/字段的名字</li>
<li>int getRowCount()：所有行/记录的数目</li>
<li>SortedMap[] getRows()：所有行/记录，每个SrotedMap对象表示一个记录，以字段名为key，以字段值为value</li>
<li>Object[][] getRowsByIndex()：查询结果，第一维表示结果的记录/行，第二维表示结果的字段/列</li>
<li>boolean isLimitedByMaxRows()：结果的记录数目是否收到标签的maxRows属性限制，若原始查询结果记录数大于maxRows，则true</li>
</ul>
</li>
<li>
<p>访问查询结果：Result类型中方法多为getter，故可用</p>
 <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach <span class="keyword">var</span>=<span class="string">"item_name"</span> items=<span class="string">"$&#123;results.rows&#125;"</span> &gt;</span><br><span class="line">    $&#123;item_name.ID&#125; </span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li>
<p><code>&lt;sql:param&gt;</code> 为SQL语句中用？表示的参数赋值</p>
 <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;sql:query <span class="keyword">var</span>=<span class="string">"books"</span> sql=<span class="string">"select * from BOOKS where PRICE&gt;?"</span>&gt;</span><br><span class="line">    &lt;sql:param&gt;35&lt;/sql:param&gt;</span><br><span class="line">&lt;/sql:query&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>&lt;sql:dateParam&gt;</code> 为SQL语句中用？表示的日期或时间类型的参数赋值，有属性：</p>
<ul>
<li>value：java.util.Date，设置SQL语句中响应参数的值</li>
<li>type：String，指定参数的类型，可选date、time、timestamp，默认timestamp</li>
</ul>
 <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;fmt:parseDate value=<span class="string">"2007-05-06"</span> type=<span class="string">"date"</span> <span class="keyword">var</span>=<span class="string">"publish_date"</span>/&gt;</span><br><span class="line">&lt;sql:query <span class="keyword">var</span>=<span class="string">"books"</span>&gt;</span><br><span class="line">    select * from BOOKS where PUBLISH_DATE=?</span><br><span class="line">    &lt;sql:dateParam value=<span class="string">"$&#123;publish_date&#125;"</span> type=<span class="string">"date"</span>/&gt;</span><br><span class="line">&lt;/sql:query&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><code>&lt;sql:update&gt;</code> insert、update、delete语句，SQL DDL语句，定义表、视图、索引，有属性：</p>
<ul>
<li>sql：待执行语句</li>
<li>dataSource：数据源，如不指定使用默认数据源</li>
<li>var：执行结果的命名变量，其执行结果是库中受影响记录数</li>
<li>scope：执行结果存放范围，默认page</li>
</ul>
</li>
<li>
<p><code>&lt;sql:transaction&gt;</code> 为其子标签query和update声明数据库事务，位于同一个<code>&lt;sql:transaction&gt;</code>中的所有<code>&lt;sql:query&gt;</code>和<code>&lt;sql:update&gt;</code>均作为一个数据库事务</p>
<ol>
<li>
<p>属性：</p>
<ul>
<li>dataSource：设置数据源，其子标签的query、update不可再设置数据源</li>
<li>isolation：事务隔离级别，隔离级别由低到高可选read_uncommitted读未提交数据、read_committed读已提交数据、repeatable_read可重复读、serializable串行化，如不设置将使用数据源默认隔离级别</li>
</ul>
</li>
<li>
<p>隔离级别能避免的并发问题：</p>
<table>
<thead>
<tr>
<th>别</th>
<th>是否第一类丢失更新</th>
<th>是否脏读</th>
<th>是否虚读</th>
<th>是否不可重复读</th>
<th>是否第二类丢失更新</th>
</tr>
</thead>
<tbody>
<tr>
<td>ializable</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>eatable_read</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>d_commited</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>d_uncommited</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
</tbody>
</table>
<p>隔离级别逐渐降低，但对并发性能影响也逐渐降低，通常优先考虑read_committed级别。</p>
</li>
</ol>
</li>
</ol>
<p> </p>
<h2><span id="6-functions"> 6. Functions</span></h2>
<p>本标签库中提供了常用的EL函数，主要用于处理字符串。</p>
<p><code>&lt;%@ taglib prefix=&quot;fn&quot; uri=&quot;http://java.sun.com/jsp/jstl/functions&quot; %&gt;</code></p>
<p>另，因为是EL函数，参数传递时，若非直接写出，而是用变量名时，要用命名变量，即要先set进Attribute，可用Java片段或<code>&lt;c:set&gt;</code>标签</p>
<ol>
<li><code>fn:contains(String source, String target)</code>：返回boolean，主串中是否包含目标串</li>
<li><code>fn:containIgnoreCases(String source, String target)</code>：boolean，是否包含子串，忽略大小写</li>
<li><code>fn:startWith(String source, String target)</code>：boolean，source串是否以target串开头</li>
<li><code>fn:endsWith(String source, String target)</code>：boolean，是否以目标串结束</li>
<li><code>fn:indexOf(String source, String target)</code>：int，子串匹配，返回主串中匹配位置首位的索引（0开始），不匹配则-1</li>
<li><code>fn:replace(String source, String before, String after)</code>：String，在source主串中，以after串替换掉before串，返回结果串</li>
<li><code>fn:substring(String source, int beginIndex, int endIndex)</code>：String，获取主串中的子串，不包含endIndex</li>
<li><code>fn:substringBefore(String source, String target)</code>：String，获取主串中指定子串之前的内容</li>
<li><code>fn:substringAfter(String source, String target)</code>：String，获取主串中指定子串之后的内容</li>
<li><code>fn:split(String source, String delimiter)</code>：String[]，将主串根据delimiter分隔符分割成字符串数组，如不包含delimiter或delimiter为空，则返回数组中仅有原主串</li>
<li><code>fn:join(String[] source, String separator)</code>：String，将原字符串数组，和分隔符，连接为一个串</li>
<li><code>fn:toLowerCase(String source)</code>：String</li>
<li><code>fn:toUpperCase(String source)</code>：String</li>
<li><code>fn:trim(String source)</code>：String</li>
<li><code>fn:escapeXml(String source)</code>：String，将串中&lt;，&gt;，&amp;等字符串转换为转义字符，转译后即可输出原字符，而非编译后的xml格式</li>
<li><code>fn:length(source)</code>：int，字符串中字符个数，或集合和数组中元素个数</li>
</ol>
<p> </p>

        </div>

        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/%E5%90%8E%E7%AB%AF/"># 后端</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/02/27/%E7%AE%80%E5%8D%95%E6%A0%87%E7%AD%BE%E5%92%8C%E6%A0%87%E7%AD%BE%E6%96%87%E4%BB%B6/">简单标签和标签文件</a>
            
            
            <a class="next" rel="next" href="/2021/02/27/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E6%9D%BF/">设计模板</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© gaylong9 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
